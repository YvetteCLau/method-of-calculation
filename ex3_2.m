%3.b)
clear
clc

A = [51, 49, 23, 4, 68, 71, 74;
     9, 58, 49, 88, 14, 90, 50;
     26, 24, 62, 91, 72, 89, 48;
     80, 46, 68, 79, 11, 34, 90;
     3, 96, 40, 10, 65, 70, 61;
     92, 55, 37, 26, 49, 20, 62;
     73, 52, 98, 34, 78, 4, 86];

b1 = [340; 358; 412; 408; 345; 341; 425];
b2 = [1518; 1584; 1854; 1581; 1527; 1216; 1623];

[B, p, q] = lu_factorization_full(A);

%求解 Ax = b1
x1 = Gauss_LU_full(B, p, q, b1);

%求解 Ax = b2
x2 = Gauss_LU_full(B, p, q, b2);

%输出
disp('方程组 Ax = b1 的解 x1：');
disp(x1);

disp('方程组 Ax = b2 的解 x2：');
disp(x2);

%验证解的正确性
disp('验证 A * x1 ≈ b1：');
disp(A * x1 - b1);  % 结果应接近零向量

disp('验证 A * x2 ≈ b2：');
disp(A * x2 - b2);  % 结果应接近零向量